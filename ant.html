<html>
<head>
	<title>tlbimp Ant Task</title>
	<meta http-equiv="Content-type" value="text/html; charset=iso-8859-1" />
	<style>
		pre.cmd {
			background-color: black;
			color: white;
			font-weight: bold;
			margin-left: 2em;
			padding: 0.5em;
		}
		
		pre.code {
			border: black solid 1px;
			background-color: rgb(240,240,255);
			color: navy;
			font-weight: bold;
			margin-left: 2em;
			padding: 0.5em;
		}
		
		pre.code .annotation {
			color: gray;
		}
		
		.app table {
			border-collapse: collapse;
			border-spacing: 3px;
		}
		.app td {
			border: gray solid 1px;
			padding: 2px;
		}
	</style>
</head>
<body><div class=app>
<h1>tlbimp Ant Task</h1>



<!--h3>Generate Type Definitions</h3-->
<p>
	<tt>tlbimp.jar</tt> comes with an implementation of Apache Ant task so that you can integrate tlbimp into your build process easily.

<p>
	To declare the <tt>tlbimp</tt> task, include the following statement in your build script:
<pre class=code><xmp
><taskdef resource="/com4j/tlbimp/ant.properties">
  <classpath>
    <fileset dir="dir/to/com4j" includes="**/*.jar"/>
  </classpath>
</taskdef>
</xmp></pre>


<h3>Synopsis</h3>
<p>
	The <tt>tlbimp</tt> task supports the following attributes.

<table width=100%>
<tr><td>
	Attribute
</td><td>
	Description
</td><td>
	Required
</td></tr>

<tr><td>
	destdir
</td><td>
	The output directory in which all the generated files will be placed.
	The package name will be automatically appended to this directory.
</td><td>
	Yes
</td></tr>

<tr><td>
	package
</td><td>
	The default Java package name in which the generated types will be placed
	(unless overriden by &lt;lib @package="..." />)
</td><td>
	No. Defaults to ""
</td></tr>

<tr><td>
	locale
</td><td>
	The locale to be used to convert method names and others.
	This is a string like "en_US", "ja_JP", etc.
</td><td>
	No. Defaults to the system default locale
</td></tr>
<!--
<tr><td>
</td><td>
</td><td>
</td></tr>
-->
</table>

<h3>Nested Elements</h3>
<h4>&lt;lib> element</h4>
<p>
	A &lt;lib> element specifies one type library to compile.
	Sometimes a type library depends on other type libraries. Multiple lib elements can be used in this situation to control where each of the referenced type libraries are generated.
</p><p>
	This element can take the following attributes:
</p>
<table>

<tr><td>
	file
</td><td>
	A file that contains the type library to be processed.
</td><td rowspan=2>
	One of two.
</td></tr>

<tr><td>
	libid
</td><td>
	The LIBID of the type library to be processed.
	A string of the form "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
</td></tr>

<tr><td>
	libver
</td><td>
	The version of the type library given by @libid to be processed.
	When omitted, tlbimp searches the latest version and process it.
	A string of the form "<i>major</i>.<i>minor</i>"
</td><td>
	No. only valid with @libid
</td></tr>
<!--
<tr><td>
</td><td>
</td><td>
</td></tr>
-->
</table>

<h4>LIBID and LIBVER</h4>
<p>
	@libid and @libver needs more explanation. Often, the location of type libraries vary from a system to system.
 For example, the type library for Microsoft Office is installed in the same directory where the user installed Microsoft Office. Because people install things in different places, when multiple people are working on the same project, this makes it difficult to consistently refer to the same type library.
<p>
	@libid and @libver are useful in this case. Each type library has a unique GUID called "LIBID", and the version of the type library. For example, Microsoft Excel 2000 type library has the LIBID of "00020813-0000-0000-C000-000000000046" and the version of "1.3". Together they allow you to reference a type library without knowing its actual location on the disk.
<p>
	To find out the LIBID, the library version, and its dependencies, use <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=5233b70d-d9b2-4cb5-aeb6-45664be858b6&displaylang=en">OleView</a>.

<h3>Examples</h3>
<p>
	Compile Microsoft Excel type library without refering to the file path.
<pre class=code><xmp
><!-- compile Excel -->
<tlbimp destdir="build/src" package="excel.types">
  <lib libid="00020813-0000-0000-C000-000000000046" libver="1.3" />
</tlbimp>
</xmp></pre>

<p>
	Compile Microsoft PowerPoint type library and its dependencies.
<pre class=code><xmp
><!-- compile PowerPoint -->
<tlbimp destdir="build/src">
  <lib libid="91493440-5A91-11CF-8700-00AA0060263B" package="ppt" />
  <lib libid="0002E157-0000-0000-C000-000000000046" package="vba" />
  <lib libid="2DF8D04C-5BFA-101B-BDE5-00AA0044DE52" package="office" />
</tlbimp>
</xmp></pre>

</div>
</body>
</html>
